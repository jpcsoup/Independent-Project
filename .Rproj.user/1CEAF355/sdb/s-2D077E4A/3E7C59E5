{
    "contents" : "#This code is not finalized and is still being modified while finalizing analysis\n#Please contact me at jpcsoup@gmail.com if you intend to use this code outside personal or academic use\n\n#Adding Pew typology clusters to dataframes for aggregate comparison\ndf1 <- merge(df1,typo,by.x=\"V1\",by.y=\"mergeid\")\ndf2 <- merge(df2,typo,by.x=\"V1\",by.y=\"mergeid\")\ndf3 <- merge(df3,typo,by.x=\"V1\",by.y=\"mergeid\")\ndf4 <- merge(df4,typo,by.x=\"V1\",by.y=\"mergeid\")\n\n#Create summary tables of cluster means for Pew's typologies\npew1<-aggregate(df1[,2:20],by=list(df1$finaltypo),FUN=mean,na.rm=TRUE)\npew2<-aggregate(df2[,2:10],by=list(df2$finaltypo),FUN=mean,na.rm=TRUE)\npew3<-aggregate(df3[,2:20],by=list(df3$finaltypo),FUN=mean,na.rm=TRUE)\npew4<-aggregate(df4[,2:10],by=list(df4$finaltypo),FUN=mean,na.rm=TRUE)\n\n#melting dataframes for line plot\npewplot <- melt(pew2,id.vars=c(\"Group.1\"))\n#Reverse the order of the levels such that they align with the red/blue scale\npewplot$Group.1 <- factor(pewplot$Group.1, levels = rev(levels(pewplot$Group.1)))\n\nggplot(pewplot, aes(x=variable, y=value, color=as.factor(Group.1))) + \n  geom_point(size=6) + theme_bw() +\n  theme( # remove the horizontal grid lines\n    panel.grid.major.y = element_blank() ,\n    # explicitly set the vertical lines (or they will disappear too)\n    panel.grid.major.x = element_line( size=5, color=\"honeydew3\")) +\n  scale_colour_brewer(palette=\"RdBu\") +\n  labs(title=\"Pew Typology Values\\nTransformation 1\", color = \"Typology\") \n  \n  \n#\n  ggplot(pewplot, aes(x=variable, y=value, color=as.factor(Group.1))) + \n  geom_point(size=2) + theme_bw() +\n  theme( # remove the horizontal grid lines\n    panel.grid.major.y = element_blank() ,\n    # explicitly set the vertical lines (or they will disappear too)\n    panel.grid.major.x = element_line( size=1, color=\"honeydew3\")) +\n  #scale_colour_brewer(palette=\"RdBu\") +\n  labs(title=\"Pew Typology Values\\nTransformation 1\", color = \"Typology\") +\n  facet_grid(.~Group.1)\n\n#install.packages(\"fmsb\")\nlibrary(fmsb)\n\n#plots for 1st transformation\nclass1 <- c(6,2,4,7,8,3,1,5)\npar(oma=c(0,0,3,0),mfrow=c(2,4)) #combine 8 radar plots into one\nfor ( i in 1:8){\n  radar <- as.data.frame(matrix(2,4,19))\n  radar[2,]<-rep(-2,19)\n  radar[3,] <- pew1[i,2:20]\n  radar[4,] <- table1[class1[i],2:20]\n  radarchart(radar, title = pew1[i,1])}\nmtext(\"Transformation 1\\nPew Typology and K-means Cluster Values\",\n      side=3, line=-.75, font=2, cex=1, outer = TRUE) #plot title\npar(usr=c(0,1,0,1), # Reset the coordinates\n    xpd=NA) #Allow plottting outside the last plot\nlegend(0,4.2, # Placement at top right of plot\n       c(\"Pew Typology\", \"K-means Analysis\"), lty=1, lwd=3, \n       col=c(\"black\", \"red\"))\n#plots for 2nd transformation\nclass2 <- c(3,7,6,4,1,2,5,8)\npar(oma=c(0,0,3,0),mfrow=c(2,4)) #combine 8 radar plots into one\nfor (i in 1:8){\n  radar <-as.data.frame(matrix(2,4,9))\n  radar[2,] <- rep(-2,9)\n  radar[3,] <- pew2[i,2:10]\n  radar[4,] <- table2[class2[i],2:10]\n  radarchart(radar, title = pew2[i,1])\n}\nmtext(\"Transformation 2\\nPew Typology and K-means Cluster Values\",\n      side=3, line=-.75, font=2, cex=1, outer = TRUE) # plot title\npar(usr=c(0,1,0,1), # Reset the coordinates\n    xpd=NA) #Allow plottting outside the last plot\nlegend(0,4.2, # Placement at top right of plot\n       c(\"Pew Typology\", \"K-means Analysis\"), lty=1, lwd=3, \n       col=c(\"black\", \"red\"))\n#plots for 3rd transformation\nclass3 <- c(7,2,5,6,1,8,3,4)\npar(oma=c(0,0,3,0),mfrow=c(2,4)) #combine 8 radar plots into one\nfor (i in 1:8){\n  radar <- as.data.frame(matrix(2,4,19))\n  radar[2,]<-rep(-2,19)\n  radar[3,]<-pew3[i,2:20]\n  radar[4,]<-table3[class3[i],2:20]\n  radarchart(radar, title = pew3[i,1])\n}\nmtext(\"Transformation 3\\nPew Typology and K-means Cluster Values\",\n      side=3, line=-.75, font=2, cex=1, outer = TRUE) #plot title\npar(usr=c(0,1,0,1), # Reset the coordinates\n    xpd=NA) #Allow plottting outside the last plot\nlegend(0,4.2, # Placement at top right of plot\n       c(\"Pew Typology\", \"K-means Analysis\"), lty=1, lwd=3, \n       col=c(\"black\", \"red\"))\n#plots for 4th transformation\nclass4 <- c(6,7,2,3,8,4,5,1)\npar(oma=c(0,0,3,0),mfrow=c(2,4)) #combine 8 radar plots into one\nfor (i in 1:8){\n  radar <-as.data.frame(matrix(2,3,9))\n  radar[2,] <- rep(-2,9)\n  radar[3,] <- pew4[i,2:10]\n  radar[4,] <- table4[class4[i],2:10]\n  #radarchart(radar, title = as.character(table4[i,1]))\n  radarchart(radar, title = pew4[i,1])\n}\nmtext(\"Transformation 4\\nPew Typology and K-means Cluster Values\",\n      side=3, line=-.75, font=2, cex=1, outer = TRUE) #plot title\npar(usr=c(0,1,0,1), # Reset the coordinates\n    xpd=NA) #Allow plottting outside the last plot\nlegend(0,4.2, # Placement at top right of plot\n       c(\"Pew Typology\", \"K-means Analysis\"), lty=1, lwd=3, \n       col=c(\"black\", \"red\"))",
    "created" : 1424135666342.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "4148120355",
    "id" : "3E7C59E5",
    "lastKnownWriteTime" : 1424636641,
    "path" : "~/Desktop/Columbia/Fall/2-Data Analysis/Independent Project/RadarPlots.R",
    "project_path" : "RadarPlots.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}