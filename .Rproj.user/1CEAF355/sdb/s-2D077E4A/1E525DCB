{
    "contents" : "#This code is not finalized and is still being modified while finalizing analysis\n#Please contact me at jpcsoup@gmail.com if you intend to use this code outside personal or academic use\n\n#Large portions of the clustering method were taken from http://www.mattpeeples.net/kmeans.html\n\n#Starting points for each cluster\n#------------------------------------------------------------------------------------#\n\nlibrary(psych)\nlibrary(cluster)\n#omit lines that contain a NA and subset\nsub1=na.omit(df1)[,2:20]\nsub=sub1[,2:20]\n\nsub2=na.omit(df2)[,2:10]\nsub=sub2[,2:10]\n\nsub3=na.omit(df3)[,2:20]\nsub=sub3[,2:20]\n\nsub4=na.omit(df4)[,2:10]\nsub=sub4[,2:10]\n\n#create plot of cluster explanatory power\nwss <- (nrow(sub)-1)*sum(apply(sub,2,var))\nfor (i in 2:15) wss[i] <- sum(kmeans(sub, centers=i)$withinss)\nplot(1:15, wss, type=\"b\", xlab=\"Number of Clusters\",\n     ylab=\"Within groups sum of squares\")  \n### see where the \"elbow\" is in the number of clusters ###\n\n####################################################################\n#Inset plots of clusters standardized or corrected\nk.rand <- function(x){\n  km.rand <- matrix(sample(x),dim(x)[1],dim(x)[2])\n  rand.wss <- as.matrix(dim(x)[1]-1)*sum(apply(km.rand,2,var))\n  for (i in 2:15) rand.wss[i] <- sum(kmeans(km.rand, centers=i, iter.max=50, nstart=10)$withinss)\n  rand.wss <- as.matrix(rand.wss)\n  return(rand.wss)}\n\nk.1 <- function(x) { \n  for (i in 1:250) {\n    r.mat <- as.matrix(suppressWarnings(k.rand(sub)))\n    rand.mat[,i] <- r.mat}\n  return(rand.mat)}\n\nrand.mat <- matrix(0,15,250)\nrand.mat <- k.1(sub)\nxrange <- range(1:15)\nyrange <- range(log(rand.mat),log(wss))\nplot(xrange,yrange, type='n', xlab='Cluster Solution', ylab='Log of Within Group SSE', main='Cluster Solutions against Log of SSE')\nfor (i in 1:250) lines(log(rand.mat[,i]),type='l',col='red')\nlines(log(wss), type=\"b\", col='blue')\nlegend('topright',c('Actual Data', '250 Random Runs'), col=c('blue', 'red'), lty=1)\n\nyrange <- range(rand.mat,wss)\nplot(xrange,yrange, type='n', xlab=\"Cluster Solution\", ylab=\"Within Groups SSE\", main=\"Cluster Solutions against SSE\")\nfor (i in 1:250) lines(rand.mat[,i],type='l',col='red')\nlines(1:15, wss, type=\"b\", col='blue')\nlegend('topright',c('Actual Data', '250 Random Runs'), col=c('blue', 'red'), lty=1)\n\n\n####################################################################\n\n#Cluster Analysis for 1st transformation\n#------------------------------------------------------------------------------------#\nfit <- kmeans(sub1, 8) ### 8 k cluster solution ###\naggregate(sub1,by=list(fit$cluster),FUN=mean)  ### get cluster means ###\ntable1<-data.frame(aggregate(sub1,by=list(fit$cluster),FUN=mean))\nfit  ### see what cluster command did in detail ###\nsub1 <- data.frame(sub1, fit$cluster)  ### append cluster assignment  ###\nhead(sub1) ### look at the dataset again ###\n\n\n\n#Cluster Analysis for 2nd transformation\n#------------------------------------------------------------------------------------#\n\nfit <- kmeans(sub2, 8) ### 8 k cluster solution ###\naggregate(sub2,by=list(fit$cluster),FUN=mean)  ### get cluster means ###\ntable2<-data.frame(aggregate(sub2,by=list(fit$cluster),FUN=mean))\nfit  ### see what cluster command did in detail ###\nsub2 <- data.frame(sub2, fit$cluster)  ### append cluster assignment  ###\nhead(sub2) ### look at the dataset again ###\n\n\n\n#Cluster Analysis for 3rd transformation\n#------------------------------------------------------------------------------------#\n\nfit <- kmeans(sub3, 8) ### 8 k cluster solution ###\naggregate(sub3,by=list(fit$cluster),FUN=mean)  ### get cluster means ###\ntable3<-data.frame(aggregate(sub3,by=list(fit$cluster),FUN=mean))\nfit  ### see what cluster command did in detail ###\nsub3 <- data.frame(sub3, fit$cluster)  ### append cluster assignment  ###\nhead(sub3) ### look at the dataset again ###\n\n#Cluster Analysis for 4th transformation\n#------------------------------------------------------------------------------------#\n\nfit <- kmeans(sub4, 8) ### 8 k cluster solution ###\naggregate(sub4,by=list(fit$cluster),FUN=mean)  ### get cluster means ###\ntable4<-data.frame(aggregate(sub4,by=list(fit$cluster),FUN=mean))\nfit  ### see what cluster command did in detail ###\nsub4 <- data.frame(sub4, fit$cluster)  ### append cluster assignment  ###\nhead(sub4) ### look at the dataset again ###\n",
    "created" : 1420751335978.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1259395550",
    "id" : "1E525DCB",
    "lastKnownWriteTime" : 1424636645,
    "path" : "~/Desktop/Columbia/Fall/2-Data Analysis/Independent Project/Cluster analysis.R",
    "project_path" : "Cluster analysis.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}