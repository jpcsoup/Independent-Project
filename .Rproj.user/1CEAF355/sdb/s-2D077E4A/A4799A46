{
    "contents" : "#This code is not finalized and is still being modified while finalizing analysis\n#Please contact me at jpcsoup@gmail.com if you intend to use this code outside personal or academic use\n\n#Upload data into R dataframe\n#------------------------------------------------------------------------------------#\n\nlibrary(foreign)\ndf2011 <- read.spss(\"/Users/JonathanCampbell/Desktop/Pew Typology/Pew's 2011 Typology Survey/2011 Political Typology Survey/2011 Political Typology public.sav\",to.data.frame=TRUE)\n\n#Create subset for manipulation and analysis\n#------------------------------------------------------------------------------------#\n\n#subset cluster variables based off of: http://www.people-press.org/2011/05/04/about-the-political-typology/\ncvar <- c(\"mergeid\", \"q17a\", \"q17b\", \"q37u\", \"q37w\", \"q37aa\", \"q17m\", \"q17n\", \"q37q\", \"q37r\",\n          \"q17g\", \"q37dd\", \"q17f\", \"q37hh\", \"q17c\", \"q17d\", \"q17i\", \"q37bb\", \"q37y\", \"q37z\")\ndf <- subset(df2011, df2011$bys == 0, select = cvar)\n\n#Data transformation No. 1\n#------------------------------------------------------------------------------------#\n\n#recode variables on an ordinal scale\nlibrary(plyr)\ndf1<-matrix(nrow=2818,ncol=20)\nfor (i in 1:20){\n  df1[,i] <- mapvalues(df[,i], from = levels(df[,2]), to = c(1,2,5,4,3,NA))}\n#step above does not work, converts factor levels to factor level defined by to\n#to fix switch the level 3 and 5\nfor (i in 1:20){\n  df1[,i] <- mapvalues(df1[,i], from = c(5,3), to = c(3,5))}\n#change to a -2 to +2 scale\nfor (i in 1:20){\n  df1[,i] <- mapvalues(df1[,i], from = c(1:5,NA), to = c(-2,-1,0,1,2,NA))}\n\n#recode individual questions so they are on the same/comparable value scales\nrecode <- c(1,1,-1,1,-1,1,1,1,-1,1,-1,1,-1,1,1,-1,-1,-1,-1,1)\nfor (i in 1:20){\n  df1[,i]<- recode[i]*df1[,i]}\n\n#Data transformation No. 2\n#------------------------------------------------------------------------------------#\n\n#Make a matrix of NA positions for summed totals\ndfna<-matrix(nrow=2818,ncol=10)\ndfna[, 1] =is.na(df1[, 1])\ndfna[, 2] =is.na(df1[, 2])+is.na(df1[, 3])\ndfna[, 3] =is.na(df1[, 4])+is.na(df1[, 5])+is.na(df1[, 6])\ndfna[, 4] =is.na(df1[, 7])+is.na(df1[, 8])\ndfna[, 5] =is.na(df1[, 9])+is.na(df1[,10])\ndfna[, 6] =is.na(df1[,11])+is.na(df1[,12])\ndfna[, 7] =is.na(df1[,13])+is.na(df1[,14])\ndfna[, 8] =is.na(df1[,15])+is.na(df1[,16])\ndfna[, 9] =is.na(df1[,17])+is.na(df1[,18])\ndfna[,10] =is.na(df1[,19])+is.na(df1[,20])\n#recode column to account for 3 columns\ndfna[, 3]=mapvalues(dfna[,3], from = c(0,1,2,3), to = c(0,1,1,2))\n#recode so that only locations that are both NA's will be NA\nfor (i in 1:10){\n  dfna[,i]=mapvalues(dfna[,i], from = c(0,1,2), to = c(0,0,NA))}\n\n#Create new dataframe of summed values\n#takes the mean of the values (rm NA) and adds the value of the NA matrix\ndf2<-matrix(nrow=2818,ncol=10)\nfor (i in 1:2818){\n  df2[i, 1]=df1[i,1]\n  df2[i, 2]=sum(mean(c(df1[i, 2],df1[i, 3]),na.rm=TRUE),dfna[i,2])\n  df2[i, 3]=sum(mean(c(df1[i, 4],df1[i, 5],df1[i,6]),na.rm=TRUE),dfna[i,3])\n  df2[i, 4]=sum(mean(c(df1[i, 7],df1[i, 8]),na.rm=TRUE),dfna[i,4])\n  df2[i, 5]=sum(mean(c(df1[i, 9],df1[i,10]),na.rm=TRUE),dfna[i,5])\n  df2[i, 6]=sum(mean(c(df1[i,11],df1[i,12]),na.rm=TRUE),dfna[i,6])\n  df2[i, 7]=sum(mean(c(df1[i,13],df1[i,14]),na.rm=TRUE),dfna[i,7])\n  df2[i, 8]=sum(mean(c(df1[i,15],df1[i,16]),na.rm=TRUE),dfna[i,8])\n  df2[i, 9]=sum(mean(c(df1[i,17],df1[i,18]),na.rm=TRUE),dfna[i,9])\n  df2[i,10]=sum(mean(c(df1[i,19],df1[i,20]),na.rm=TRUE),dfna[i,10])\n}\n\n#Data transformation No. 3\n#------------------------------------------------------------------------------------#\n\ndf3<-matrix(nrow=2818,ncol=20)\n#map NA values to zero\nfor (i in 1:20){\n  df3[,i] <- mapvalues(df1[,i], from = c(NA), to = c(0))}\n\n#Data transformation No. 4\n#------------------------------------------------------------------------------------#\n\ndf4<-matrix(nrow=2818,ncol=10)\nfor (i in 1:2818){\n  df4[i, 1]=df3[i,1]\n  df4[i, 2]=mean(c(df3[i, 2],df3[i, 3]),na.rm=FALSE)\n  df4[i, 3]=mean(c(df3[i, 4],df3[i, 5],df3[i,6]),na.rm=FALSE)\n  df4[i, 4]=mean(c(df3[i, 7],df3[i, 8]),na.rm=FALSE)\n  df4[i, 5]=mean(c(df3[i, 9],df3[i,10]),na.rm=FALSE)\n  df4[i, 6]=mean(c(df3[i,11],df3[i,12]),na.rm=FALSE)\n  df4[i, 7]=mean(c(df3[i,13],df3[i,14]),na.rm=FALSE)\n  df4[i, 8]=mean(c(df3[i,15],df3[i,16]),na.rm=FALSE)\n  df4[i, 9]=mean(c(df3[i,17],df3[i,18]),na.rm=FALSE)\n  df4[i,10]=mean(c(df3[i,19],df3[i,20]),na.rm=FALSE)\n}",
    "created" : 1420751301610.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2364566684",
    "id" : "A4799A46",
    "lastKnownWriteTime" : 1424636647,
    "path" : "~/Desktop/Columbia/Fall/2-Data Analysis/Independent Project/Data Transformation.R",
    "project_path" : "Data Transformation.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}